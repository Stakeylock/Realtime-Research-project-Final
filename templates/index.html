<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breast Cancer Risk Prediction Tool</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <h1>Breast Cancer Risk Prediction Tool</h1>
        <p class="subtitle">A comprehensive analysis platform for breast cancer risk assessment</p>
    </header>

    <main>
        <section class="patient-info-section">
            <h2>Patient Information & Medical History</h2>
            <p class="description">Please complete the following questionnaire to provide important context for risk assessment.</p>
            
            <form id="patientQuestionnaireForm">
                <div class="form-section">
                    <h3>Personal Information</h3>
                    <div class="form-group">
                        <label for="patientId">Patient ID:</label>
                        <input type="text" id="patientId" name="patientId">
                    </div>
                    <div class="form-group">
                        <label for="name">Name:</label>
                        <input type="text" id="name" name="name">
                    </div>
                    <div class="form-group">
                        <label for="age">Age:</label>
                        <input type="number" id="age" name="age" min="18" max="120">
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender:</label>
                        <select id="gender" name="gender">
                            <option value="Female">Female</option>
                            <option value="Male">Male</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Family History</h3>
                    <div class="form-group">
                        <label for="familyHistoryBreastCancer">Family history of breast cancer:</label>
                        <select id="familyHistoryBreastCancer" name="familyHistoryBreastCancer">
                            <option value="No">No</option>
                            <option value="Yes">Yes</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="familyHistoryOtherCancers">Family history of other cancers:</label>
                        <select id="familyHistoryOtherCancers" name="familyHistoryOtherCancers">
                            <option value="No">No</option>
                            <option value="Yes">Yes</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="relativesWithBreastCancer">Relatives with breast cancer:</label>
                        <input type="text" id="relativesWithBreastCancer" name="relativesWithBreastCancer" placeholder="e.g., Mother, Sister, etc.">
                    </div>
                    <div class="form-group">
                        <label for="relativesDiagnosisAge">Age of relatives at diagnosis:</label>
                        <input type="text" id="relativesDiagnosisAge" name="relativesDiagnosisAge" placeholder="e.g., Mother: 45, Sister: 50">
                    </div>
                </div>

                <div class="form-section">
                    <h3>Personal Medical History</h3>
                    <div class="form-group">
                        <label for="previousBreastBiopsies">Previous breast biopsies:</label>
                        <select id="previousBreastBiopsies" name="previousBreastBiopsies">
                            <option value="No">No</option>
                            <option value="Yes">Yes</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="previousBreastCancer">Previous breast cancer:</label>
                        <select id="previousBreastCancer" name="previousBreastCancer">
                            <option value="No">No</option>
                            <option value="Yes">Yes</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hormoneReplacementTherapy">Hormone replacement therapy:</label>
                        <select id="hormoneReplacementTherapy" name="hormoneReplacementTherapy">
                            <option value="No">No</option>
                            <option value="Yes, currently">Yes, currently</option>
                            <option value="Yes, previously">Yes, previously</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ageFirstPeriod">Age at first menstrual period:</label>
                        <input type="number" id="ageFirstPeriod" name="ageFirstPeriod" min="8" max="20">
                    </div>
                    <div class="form-group">
                        <label for="ageFirstBirth">Age at first live birth:</label>
                        <input type="number" id="ageFirstBirth" name="ageFirstBirth" min="12" max="60">
                        <label class="checkbox-label">
                            <input type="checkbox" id="noChildren" name="noChildren">
                            No children
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="menopausalStatus">Menopausal status:</label>
                        <select id="menopausalStatus" name="menopausalStatus">
                            <option value="Premenopausal">Premenopausal</option>
                            <option value="Perimenopausal">Perimenopausal</option>
                            <option value="Postmenopausal">Postmenopausal</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Lifestyle Factors</h3>
                    <div class="form-group">
                        <label for="alcoholConsumption">Alcohol consumption:</label>
                        <select id="alcoholConsumption" name="alcoholConsumption">
                            <option value="None">None</option>
                            <option value="Occasional">Occasional (1-3 drinks/week)</option>
                            <option value="Moderate">Moderate (4-7 drinks/week)</option>
                            <option value="Heavy">Heavy (>7 drinks/week)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="smokingStatus">Smoking status:</label>
                        <select id="smokingStatus" name="smokingStatus">
                            <option value="Never">Never smoked</option>
                            <option value="Former">Former smoker</option>
                            <option value="Current">Current smoker</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="physicalActivity">Physical activity level:</label>
                        <select id="physicalActivity" name="physicalActivity">
                            <option value="Sedentary">Sedentary</option>
                            <option value="Light">Light (1-2 days/week)</option>
                            <option value="Moderate">Moderate (3-5 days/week)</option>
                            <option value="Active">Active (6-7 days/week)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="bmi">BMI:</label>
                        <input type="number" id="bmi" name="bmi" step="0.1" min="10" max="50">
                    </div>
                </div>

                <button type="submit" id="saveQuestionnaireButton">Save Patient Information</button>
                <button type="button" id="resetQuestionnaireButton" class="reset-button">Reset</button>
            </form>
        </section>

        <section class="upload-section">
            <h2>Upload Mammogram Image</h2>
            <p class="description">Upload a mammogram image for analysis. Supported formats: JPG, PNG.</p>
            <input type="file" id="imageUpload" accept=".jpg, .jpeg, .png">
            <button id="predictButton">Predict</button>
        </section>

        <section class="gene-upload-section">
            <h2>Upload Gene Expression Data (CSV/TSV)</h2>
            <p class="description">Upload a single-row CSV or TSV file with gene names as column headers and their corresponding expression values.</p>
            <input type="file" id="geneDataUpload" accept=".csv,.tsv,.txt">
            <button id="predictGeneButton">Predict Gene Data</button>
        </section>

        <section class="results-section">
            <h2>Analysis Results</h2>
            
            <div class="image-results">
                <div class="image-container">
                    <h3>Original Image</h3>
                    <div class="image-placeholder" id="originalImagePlaceholder">No image uploaded</div>
                    <img id="originalImage" style="display: none;" alt="Original mammogram image">
                </div>
                
                <div class="image-container">
                    <h3>Visualization</h3>
                    <div class="image-placeholder" id="visualizationImagePlaceholder">Prediction results will appear here</div>
                    <img id="visualizationImage" style="display: none;" alt="Visualization of model predictions">
                </div>
            </div>
            
            <div class="prediction-output">
                <h2>Image Prediction Result</h2>
                <div id="resultText">N/A</div>
                <h3>Ensemble Probability</h3>
                <div id="ensembleProbability">N/A</div>
                <h3>Individual Model Predictions</h3>
                <div id="modelPredictionsContainer" class="predictions-grid">
                    <p class="placeholder-text">No individual predictions yet.</p>
                </div>
            </div>

            <div class="gene-prediction-output">
                <h2>Gene Model Prediction</h2>
                <div id="geneResultText">Predicted class malignancy status</div>
                <h3>Prediction Probability</h3>
                <div id="genePredictionProbability">N/A</div>
            </div>
            
            <div class="report-section">
                <h2>Generate Comprehensive Report</h2>
                <p class="description">Generate a detailed medical report based on all available patient data, imaging results, and gene expression analysis.</p>
                <button id="generateReportButton">Generate Medical Report</button>
                <!-- Inside your report section in index.html -->
                <button id="printReportButton">Print Report</button>
                <button id="downloadReportButton">Download Report PDF</button>
                
                <div class="medical-report" id="medicalReportContainer">
                    <div class="report-placeholder" id="reportPlaceholder">Complete the questionnaire and run predictions to generate a report</div>
                    <div id="medicalReport" style="display: none;"></div>
                </div>
            </div>
        </section>
    </main>

    <div class="spinner" id="loadingSpinner">
        <div class="spinner-inner"></div>
        <div class="spinner-text">Processing...</div>
    </div>

    <footer>
        <p>Breast Cancer Risk Prediction Tool &copy; 2023</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>